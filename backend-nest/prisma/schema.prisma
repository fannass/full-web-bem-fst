generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model cabinets {
  id          BigInt      @id @default(autoincrement()) @db.UnsignedBigInt
  period_id   BigInt      @db.UnsignedBigInt
  name        String      @db.VarChar(255)
  tagline     String?     @db.VarChar(255)
  logo        String?     @db.VarChar(255)
  vision      String?     @db.Text
  mission     String?     @db.Text
  description String?     @db.Text
  created_at  DateTime?   @db.Timestamp(0)
  updated_at  DateTime?   @db.Timestamp(0)
  periods     periods     @relation(fields: [period_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "cabinets_period_id_foreign")
  divisions   divisions[]

  @@index([period_id], map: "cabinets_period_id_foreign")
}

model divisions {
  id          BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  cabinet_id  BigInt    @db.UnsignedBigInt
  name        String    @db.VarChar(255)
  description String?   @db.Text
  order       Int       @default(0)
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)
  cabinets    cabinets  @relation(fields: [cabinet_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "divisions_cabinet_id_foreign")
  members     members[]

  @@index([cabinet_id], map: "divisions_cabinet_id_foreign")
  @@index([order], map: "divisions_order_idx")
}

/// Tabel sisa Laravel — tidak digunakan oleh NestJS
model failed_jobs {
  id         BigInt   @id @default(autoincrement()) @db.UnsignedBigInt
  uuid       String   @unique(map: "failed_jobs_uuid_unique") @db.VarChar(255)
  connection String   @db.Text
  queue      String   @db.Text
  payload    String   @db.LongText
  exception  String   @db.LongText
  failed_at  DateTime @default(now()) @db.Timestamp(0)

  @@ignore
}

/// Tabel sisa Laravel — tidak digunakan oleh NestJS
model media {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  file_name  String    @db.VarChar(255)
  file_path  String    @db.VarChar(255)
  mime_type  String    @db.VarChar(255)
  size       BigInt    @db.UnsignedBigInt
  alt_text   String?   @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)

  @@ignore
}

model members {
  id          BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  division_id BigInt    @db.UnsignedBigInt
  name        String    @db.VarChar(255)
  prodi       String    @db.VarChar(255)
  position    String    @db.VarChar(255)
  photo       String?   @db.VarChar(255)
  bio         String?   @db.Text
  instagram   String?   @db.VarChar(255)
  linkedin    String?   @db.VarChar(255)
  order       Int       @default(0)
  created_at  DateTime? @db.Timestamp(0)
  updated_at  DateTime? @db.Timestamp(0)
  divisions   divisions @relation(fields: [division_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "members_division_id_foreign")

  @@index([division_id], map: "members_division_id_foreign")
  @@index([order], map: "members_order_idx")
}

/// Tabel migrasi Laravel — tidak relevan untuk NestJS/Prisma
model migrations {
  id        Int    @id @default(autoincrement()) @db.UnsignedInt
  migration String @db.VarChar(255)
  batch     Int

  @@ignore
}

/// Tabel Spatie RBAC Laravel — tidak digunakan oleh NestJS
model model_has_permissions {
  permission_id BigInt @db.UnsignedBigInt
  model_type    String @db.VarChar(255)
  model_id      BigInt @db.UnsignedBigInt

  @@id([permission_id, model_id, model_type])
  @@index([model_id, model_type], map: "model_has_permissions_model_id_model_type_index")
  @@ignore
}

/// Tabel Spatie RBAC Laravel — tidak digunakan oleh NestJS
model model_has_roles {
  role_id    BigInt @db.UnsignedBigInt
  model_type String @db.VarChar(255)
  model_id   BigInt @db.UnsignedBigInt

  @@id([role_id, model_id, model_type])
  @@index([model_id, model_type], map: "model_has_roles_model_id_model_type_index")
  @@ignore
}

model organizations {
  id           BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name         String    @db.VarChar(255)
  logo         String?   @db.VarChar(255)
  description  String?   @db.Text
  address      String?   @db.VarChar(255)
  email        String?   @db.VarChar(255)
  phone        String?   @db.VarChar(255)
  social_media Json?
  created_at   DateTime? @db.Timestamp(0)
  updated_at   DateTime? @db.Timestamp(0)
}

/// Tabel pages Laravel — tidak digunakan oleh NestJS
model pages {
  id               BigInt       @id @default(autoincrement()) @db.UnsignedBigInt
  title            String       @db.VarChar(255)
  slug             String       @unique(map: "pages_slug_unique") @db.VarChar(255)
  content          String       @db.LongText
  meta_title       String?      @db.VarChar(255)
  meta_description String?      @db.Text
  status           pages_status @default(draft)
  created_at       DateTime?    @db.Timestamp(0)
  updated_at       DateTime?    @db.Timestamp(0)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model password_resets {
  email      String    @db.VarChar(255)
  token      String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)

  @@index([email], map: "password_resets_email_index")
  @@ignore
}

model periods {
  id          BigInt     @id @default(autoincrement()) @db.UnsignedBigInt
  name        String     @db.VarChar(255)
  year_start  Int        @db.Year
  year_end    Int        @db.Year
  is_active   Boolean    @default(false)
  description String?    @db.Text
  created_at  DateTime?  @db.Timestamp(0)
  updated_at  DateTime?  @db.Timestamp(0)
  cabinets    cabinets[]

  @@index([is_active], map: "periods_is_active_idx")
}

/// Tabel Spatie RBAC Laravel — tidak digunakan oleh NestJS
model permissions {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name       String    @db.VarChar(255)
  guard_name String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)

  @@unique([name, guard_name], map: "permissions_name_guard_name_unique")
  @@ignore
}

/// Tabel Laravel Sanctum — tidak digunakan oleh NestJS (pakai JWT)
model personal_access_tokens {
  id             BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  tokenable_type String    @db.VarChar(255)
  tokenable_id   BigInt    @db.UnsignedBigInt
  name           String    @db.VarChar(255)
  token          String    @unique(map: "personal_access_tokens_token_unique") @db.VarChar(64)
  abilities      String?   @db.Text
  last_used_at   DateTime? @db.Timestamp(0)
  expires_at     DateTime? @db.Timestamp(0)
  created_at     DateTime? @db.Timestamp(0)
  updated_at     DateTime? @db.Timestamp(0)

  @@index([tokenable_type, tokenable_id], map: "personal_access_tokens_tokenable_type_tokenable_id_index")
  @@ignore
}

model posts {
  id               BigInt         @id @default(autoincrement()) @db.UnsignedBigInt
  title            String         @db.VarChar(255)
  slug             String         @unique(map: "posts_slug_unique") @db.VarChar(255)
  content          String         @db.LongText
  excerpt          String?        @db.Text
  featured_image   String?        @db.VarChar(255)
  category         posts_category @default(news)
  status           posts_status   @default(draft)
  author           String?        @db.VarChar(255)
  published_at     DateTime?      @db.Timestamp(0)
  meta_title       String?        @db.VarChar(255)
  meta_description String?        @db.Text
  canonical_url    String?        @db.VarChar(255)
  og_image         String?        @db.VarChar(255)
  deleted_at       DateTime?      @db.Timestamp(0)
  created_at       DateTime?      @db.Timestamp(0)
  updated_at       DateTime?      @db.Timestamp(0)

  // Index untuk query paginasi utama: WHERE deleted_at IS NULL AND status = ? ORDER BY created_at DESC
  @@index([deleted_at, status, created_at(sort: Desc)], map: "posts_list_query_idx")
  // Index untuk filter kategori
  @@index([category], map: "posts_category_idx")
}

/// Tabel Spatie RBAC Laravel — tidak digunakan oleh NestJS
model role_has_permissions {
  permission_id BigInt @db.UnsignedBigInt
  role_id       BigInt @db.UnsignedBigInt

  @@id([permission_id, role_id])
  @@index([role_id], map: "role_has_permissions_role_id_foreign")
  @@ignore
}

/// Tabel Spatie RBAC Laravel — tidak digunakan oleh NestJS
model roles {
  id         BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name       String    @db.VarChar(255)
  guard_name String    @db.VarChar(255)
  created_at DateTime? @db.Timestamp(0)
  updated_at DateTime? @db.Timestamp(0)

  @@unique([name, guard_name], map: "roles_name_guard_name_unique")
  @@ignore
}

/// Tabel sesi Laravel — tidak digunakan oleh NestJS (pakai JWT stateless)
model sessions {
  id            String  @id @db.VarChar(255)
  user_id       BigInt? @db.UnsignedBigInt
  ip_address    String? @db.VarChar(45)
  user_agent    String? @db.Text
  payload       String  @db.Text
  last_activity Int

  @@index([last_activity], map: "sessions_last_activity_index")
  @@index([user_id], map: "sessions_user_id_index")
  @@ignore
}

/// Tabel settings Laravel — tidak digunakan oleh NestJS (0 rows)
model settings {
  id    Int    @id @default(autoincrement()) @db.UnsignedInt
  key   String @db.VarChar(255)
  value String @db.Text

  @@index([key], map: "settings_key_index")
  @@ignore
}

model activity_logs {
  id           BigInt   @id @default(autoincrement()) @db.UnsignedBigInt
  action       String   @db.VarChar(100)
  entity_type  String?  @db.VarChar(50)
  entity_id    BigInt?  @db.UnsignedBigInt
  entity_title String?  @db.VarChar(255)
  actor        String   @default("admin") @db.VarChar(100)
  ip_address   String?  @db.VarChar(45)
  metadata     Json?
  created_at   DateTime @default(now()) @db.Timestamp(0)

  @@index([action], map: "activity_logs_action_index")
  @@index([created_at], map: "activity_logs_created_at_index")
  @@index([entity_type], map: "activity_logs_entity_type_idx")
}

/// Tabel users Laravel — tidak digunakan oleh NestJS (auth via .env, bukan DB users)
model users {
  id                 BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  name               String    @db.VarChar(255)
  email              String    @unique(map: "users_email_unique") @db.VarChar(255)
  email_verified_at  DateTime? @db.Timestamp(0)
  password           String    @db.VarChar(255)
  remember_token     String?   @db.VarChar(100)
  profile_photo_path String?   @db.VarChar(2048)
  created_at         DateTime? @db.Timestamp(0)
  updated_at         DateTime? @db.Timestamp(0)

  @@ignore
}

enum pages_status {
  draft
  published
}

enum posts_category {
  news
  event
}

enum posts_status {
  draft
  published
}
